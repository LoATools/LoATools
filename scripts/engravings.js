window.engravings = [
    { "id": "adrenaline", "name": "Adrenaline", "type": "combat", "text1": "Lv. 1: After using skills (excluding Movement Skills and Basic Attacks), Atk. Power +0.3% for 6s. Stacks up to 6 times. When max stacks are reached, Crit Rate +5%. If Cooldown reduction due to skill cancel is applied to this effect, it is applied after the end of the skill.", "text2": "Lv. 2: After using skills (excluding Movement Skills and Basic Attack), Atk. Power +0.6% for 6s. Stacks up to 6 times. When max stacks are reached, Crit Rate +10%. If Cooldown reduction due to skill cancel is applied to this effect, it is applied after the end of the skill.", "text3": "Lv. 3: After using skills (excluding Movement Skills and Basic Attack), Atk. Power +1% for 6s. Stacks up to 6 times. When max stacks are reached, Crit Rate +15%. If Cooldown reduction due to skill cancel is applied to this effect, it is applied after the end of the skill." },
    { "id": "all-out-attack", "name": "All-Out Attack", "type": "combat", "text1": "Lv. 1: Holding and Casting skill Speed +5%. Damage +4%.", "text2": "Lv. 2: Holding and Casting skill Speed +10%. Damage +10%.", "text3": "Lv. 3: Holding and Casting skill Speed +20%. Damage +20%." },
    { "id": "ambush-master", "name": "Ambush Master", "type": "combat", "text1": "Lv. 1: Damage +5% for successful back attacks.", "text2": "Lv. 2: Damage +12% for successful back attacks.", "text3": "Lv. 3: Damage +25% for successful back attacks." },
    { "id": "awakening", "name": "Awakening", "type": "combat", "text1": "Lv. 1: Awakening Skill Cooldown -10%. +1 maximum use.", "text2": "Lv. 2: Awakening Skill Cooldown -25%. +2 maximum uses.", "text3": "Lv. 3: Awakening Skill Cooldown -50%. +3 maximum uses." },
    { "id": "barrage-enhancement", "name": "Barrage Enhancement", "type": "class", "text1": "Lv. 1: Barrage Skill Damage +20%. If you have no Firepower Buff, Firepower Meter +10%. Once the Firepower Meter is fully recharged, removes the Cooling effect.", "text2": "Lv. 2: Barrage Skill Damage +30%. If you have no Firepower Buff, Firepower Meter +20%, Once the Firepower Meter is fully recharged, Cooling effect removed.", "text3": "Lv. 3: Barrage Skill Damage +40%. If you have no Firepower Buff, Firepower Meter +30%, Once the Firepower Meter is fully recharged, Cooling effect removed." },
    { "id": "barricade", "name": "Barricade", "type": "combat", "text1": "Lv. 1: Damage to foes while shielded +3%.", "text2": "Lv. 2: Damage to foes while shielded +8%.", "text3": "Lv. 3: Damage to foes while shielded +16%." },
    { "id": "berserkers-technique", "name": "Berserker's Technique", "type": "class", "text1": "Lv. 1: During Burst, Crit Damage +35%. Negates Exhaustion after Burst ends.", "text2": "Lv. 2: During Burst, Crit Damage +50%. Negates Exhaustion after Burst ends.", "text3": "Lv. 3: During Burst, Crit Damage +70%. Negates Exhaustion after Burst ends." },
    { "id": "blessed-aura", "name": "Blessed Aura", "type": "class", "text1": "Lv. 1: With Holy Aura, Damage received -10% and 2% of Max HP restored every 2.5s for all party members.", "text2": "Lv. 2: With Holy Aura, Damage received -15% and 2% of Max HP restored every 2s for all party members.	", "text3": "Lv. 3: With Holy Aura, Damage received -20% and 2% of Max HP restored every 1.5s for all party members." },
    { "id": "broken-bone", "name": "Broken Bone", "type": "combat", "text1": "Lv. 1: Damage to staggered foes +7.5%.", "text2": "Lv. 2: Damage to staggered foes +20%.	", "text3": "Lv. 3: Damage to staggered foes +40%.	" },
    { "id": "combat-readiness", "name": "Combat Readiness", "type": "class", "text1": "Lv. 1: Normal skills Damage +20%. Shield Amount +30% in Defensive Stance. Damage +4% for 10s when hit while in Defensive Stance (stacked up to 3 times, once every 1s).", "text2": "Lv. 2: Normal skills Damage +20%. Shield Amount +40% in Defensive Stance. Damage +5% for 10s when hit while in Defensive Stance (stacked up to 3 times, once every 1s).", "text3": "Lv. 3: Normal skills Damage +20%. Shield Amount +50% in Defensive Stance. Damage +6% for 10s when hit while in Defensive Stance (stacked up to 3 times, once every 1s)." },
    { "id": "contender", "name": "Contender", "type": "combat", "text1": "Lv. 1: Atk. Power +1% for 15s after killing a foe. (Max. 5 stacks)", "text2": "Lv. 2: Atk. Power +1.5% for 25s after killing a foe. (Max. 6 stacks)", "text3": "Lv. 3: Atk. Power +2.5% for 40s after killing a foe. (Max. 7 stacks)" },
    { "id": "control", "name": "Control", "type": "class", "text1": "Lv. 1: Cannot use Focus stance. Flurry skills Damage +18%.", "text2": "Lv. 2: Cannot use Focus stance. Flurry skills Damage +27%.", "text3": "Lv. 3: Cannot use Focus stance. Flurry skills Damage +36%." },
    { "id": "crisis-evasion", "name": "Crisis Evasion", "type": "combat", "text1": "Lv. 1: When receiving fatal Damage, become invincible for 3s, recovering 50% of the Damage taken during invincibility as HP. (Cooldown: 15m)", "text2": "Lv. 2: When receiving fatal Damage, become invincible for 3s, recovering 50% of the Damage taken during invincibility as HP. (Cooldown: 12m)", "text3": "Lv. 3: When receiving fatal Damage, become invincible for 3s, recovering 50% of the Damage taken during invincibility as HP. (Cooldown: 9m)" },
    { "id": "crushing-fist", "name": "Crushing Fist", "type": "combat", "text1": "Lv. 1: On successful Counter Attack, Atk. Power +4%. For 3s Countered target takes +2% Damage from all party members.	", "text2": "Lv. 2: On successful Counter Attack, Atk. Power +10%. For 3s Countered target takes +4% Damage from all party members.", "text3": "Lv. 3: On successful Counter Attack, Atk. Power +20%. For 3s Countered target takes +8% Damage from all party members.	" },
    { "id": "cursed-doll", "name": "Cursed Doll", "type": "combat", "text1": "Lv. 1: Atk. Power +3%. Healing -25%, natural recovery excluded.", "text2": "Lv. 2: Atk. Power +8%. Healing -25%, natural recovery excluded.", "text3": "Lv. 3: Atk. Power +16%. Healing 25%, natural recovery excluded." },
    { "id": "death-strike", "name": "Death Strike", "type": "class", "text1": "Lv. 1: When using Last Rush, recover 50% of the remaining Hawk Meter. Damage taken +22% for 8s.", "text2": "Lv. 2: When using Last Rush, recover 50% of the remaining Hawk Meter. Damage taken +33% for 8s.", "text3": "Lv. 3: When using Last Rush, recover 50% of the remaining Hawk Meter. Damage taken +44% for 8s." },
    { "id": "deathblow", "name": "Deathblow", "type": "class", "text1": "Lv. 1: Max number of Esoteric Orbs +1. Esoteric skills consume all Esoteric Orbs and inflict +17% Damage per Esoteric Orb consumed.", "text2": "Lv. 2: Max number of Esoteric Orbs +1. Esoteric skills consume all Esoteric Orbs and inflict +26% Damage per Esoteric Orb consumed.", "text3": "Lv. 3: Max number of Esoteric Orbs +1. Esoteric skills consume all Esoteric Orbs and inflict +35% Damage per Esoteric Orb consumed." },
    { "id": "demonic-impulse", "name": "Demonic Impulse", "type": "class", "text1": "Lv. 1: The Composure effect does not activate when Demonize ends. Upon Demonize, Demonic Skill Cooldown is reset.", "text2": "Lv. 2: The Composure effect does not activate when Demonize ends. Upon Demonize, Demonic Skill Cooldown is reset, and Crit Rate +15% while Demonic Mode is active.", "text3": "Lv. 3: The Composure effect does not activate when Demonize ends. Upon Demonize, Demonic Skill Cooldown is reset, and Crit Rate +30% while Demonic Mode is active." },
    { "id": "desperate-salvation", "name": "Desperate Salvation", "type": "class", "text1": "Lv. 1: When the recovery effect ends, an additional recovery effect is activated, recovering 8% of your Max HP.", "text2": "Lv. 2: When the recovery effect ends, an additional recovery effect is activated, recovering 16% of your Max HP.", "text3": "Lv. 3: When the recovery effect ends, an additional recovery effect is activated, recovering 24% of your Max HP." },
    { "id": "disrespect", "name": "Disrespect", "type": "combat", "text1": "Lv. 1: Damage +9% to foes with 30% or lower HP.", "text2": "Lv. 2: Damage +22% to foes with 30% or lower HP.", "text3": "Lv. 3: Damage +36% to foes with 30% or lower HP." },
    { "id": "divine-protection", "name": "Divine Protection", "type": "combat", "text1": "Lv. 1: When attacked, there is a 20% chance of activing Divine Protection which reduces the Damage received by 60%. (Cooldown: 60s)", "text2": "Lv. 2: When attacked, there is a 20% chance of activating Divine Protection which reduces the Damage received by 60%. (Cooldown: 20s)", "text3": "Lv. 3: When attacked, there is a 20% chance of activating Divine Protection which reduces the Damage received by 60%. (Cooldown: 10s)" },
    { "id": "drops-of-ether", "name": "Drops of Ether", "type": "combat", "text1": "Lv. 1: Attacks have a chance to create an Ether within 8 meters. (Cooldown: 60s)", "text2": "Lv. 2: Attacks have a chance to create an Ether within 8 meters. (Cooldown: 30s)	", "text3": "Lv. 3: Attacks have a chance to create an Ether within 8 meters. (Cooldown: 10s)" },
    { "id": "emergency-rescue", "name": "Emergency Rescue", "type": "combat", "text1": "Lv. 1: When HP falls below 30%, gain a shield equal to 20% of Max HP for 6s. If the shield is not destroyed after 6s, recover 50% of the remaining shield as HP. (Cooldown: 300s.)", "text2": "Lv. 2: When HP falls below 30%, gain a shield equal to 30% of Max HP for 6s. If the shield is not destroyed after 6s, recover 50% of the remaining shield as HP. (Cooldown: 240s.)", "text3": "Lv. 3: When HP falls below 30%, gain a shield equal to 50% of Max HP for 6s. If the shield is not destroyed after 6s, recover 50% of the remaining shield as HP. (Cooldown: 180s.)" },
    { "id": "energy-overflow", "name": "Energy Overflow", "type": "class", "text1": "Lv. 1: Energy does not go below 1, but additional Energy Recovery effect is not applied during Hype. If Energy is below 30%, Damage to foes +5%.", "text2": "Lv. 2: Energy does not go below 1, but additional Energy Recovery effect is not applied during Hype. If Energy is below 30%, Damage to foes +10%.", "text3": "Lv. 3: Energy does not go below 1, but additional Energy recovery effect is not applied during Hype. If Energy is below 30%, Damage to foes +15%.	" },
    { "id": "enhanced-shield", "name": "Enhanced Shield", "type": "combat", "text1": "Lv. 1: Become immune to all debuffs while affected by shields, but -90% Shields' HP and Defensive Stance's Damage absorption amounts. (Not applicable to Battlefield Shield)", "text2": "Lv. 2: Become immune to all debuffs while affected by shields, but -75% Shields' HP and Defensive Stance's Damage absorption amounts. (Not applicable to Battlefield Shield)", "text3": "Lv. 3: Become immune to all debuffs while affected by shields, but -50% Shields' HP and Defensive Stance's Damage absorption amounts. (Not applicable to Battlefield Shield)" },
    { "id": "enhanced-weapon", "name": "Enhanced Weapon", "type": "class", "text1": "Lv. 1: Changing Stances enhances your weapon. Crit Rate +20% for 9s.", "text2": "Lv. 2: Changing Stances enhances your weapon. Crit Rate +25% for 9s.", "text3": "Lv. 3: Changing Stances enhances your weapon. Crit Rate +30% for 9s." },
    { "id": "esoteric-flurry", "name": "Esoteric Flurry", "type": "class", "text1": "Lv. 1: Only 1 Esoteric Orb is used when using Esoteric Skill, and Esoteric Skill Damage +8%.", "text2": "Lv. 2: Only 1 Esoteric Orb is used when using Esoteric Skill, and Esoteric Skill Damage +13%.", "text3": "Lv. 3: Only 1 Esoteric Orb is used when using Esoteric Skill, and Esoteric Skill Damage +18%." },
    { "id": "esoteric-skill-enhancement", "name": "Esoteric Skill Enhancement", "type": "class", "text1": "Lv. 1: Max number of Esoteric Orbs +1. Esoteric skills inflict +8% Damage per Esoteric Orb you have.", "text2": "Lv. 2: Max number of Esoteric Orbs +1. Esoteric skills inflict +10% Damage per Esoteric Orb you have.", "text3": "Lv. 3: Max number of Esoteric Orbs +1. Esoteric skills inflict +12% Damage per Esoteric Orb you have." },
    { "id": "ether-predator", "name": "Ether Predator", "type": "combat", "text1": "Lv. 1: Attacking a foe creates an Ether that only you can collect. On collecting the Ether, Atk. Power +0.2% for 90s and All Defense +0.3%. Stacks up to 30 times. Chance on Ether collection to increases the stack by 3. (Cooldown: 10s)", "text2": "Lv. 2: Attacking a foe creates an Ether that only you can collect. On collecting the Ether, Atk. Power +0.3% for 90s and All Defense +0.6%. Stacks up to 30 times. Chance on Ether collection to increases the stack by 3. (Cooldown: 10s)", "text3": "Lv. 3: Attacking a foe creates an Ether that only you can collect. On collecting the Ether, Atk. Power +0.5% for 90s and All Defense +1%. Stacks up to 30 times. Chance on Ether collection to increases the stack by 3. (Cooldown: 10s)" },
    { "id": "expert", "name": "Expert", "type": "combat", "text1": "Lv. 1: Shield and Healing effectiveness on all Party Members +6%. If target's HP is 50% or lower, +3% additional effectiveness.", "text2": "Lv. 2: Shield and Healing effectiveness on all Party Members +14%. If target's HP is 50% or lower, +7% additional effectiveness.", "text3": "Lv. 3: Shield and Healing effectiveness on all Party Members +24%. If target's HP is 50% or lower, +12% additional effectiveness." },
    { "id": "explosive-expert", "name": "Explosive Expert", "type": "combat", "text1": "Lv. 1: Bomb/grenade Battle Item carrying limit +1.", "text2": "Lv. 2: Bomb/grenade Battle Item carrying limit +2.", "text3": "Lv. 3: Bomb/grenade Battle Item carrying limit +3." },
    { "id": "firepower-enhancement", "name": "Firepower Enhancement", "type": "class", "text1": "Lv. 1: Incoming Damage -20%. Crit Rate +(15%, 20%, 25% ) depending on the level of the Firepower Buff.", "text2": "Lv. 2: Incoming Damage -20%. Crit Rate +(22%, 27%, 32%) depending on the level of the Firepower Buff.", "text3": "Lv. 3: Incoming Damage -20%. Crit Rate +(30%, 35%, 40%) depending on the level of the Firepower Buff." },
    { "id": "first-intention", "name": "First Intention", "type": "class", "text1": "Lv. 1: Damage to foes +16%, but you can no longer gain Esoteric Meter.", "text2": "Lv. 2: Damage to foes +24%, but you can no longer gain Esoteric Meter.", "text3": "Lv. 3: Damage to foes +32%, but you can no longer gain Esoteric Meter." },
    { "id": "fortitude", "name": "Fortitude", "type": "combat", "text1": "Lv. 1: Incoming Damage is reduced proportional to HP lost. (Max. 5%)", "text2": "Lv. 2: Incoming Damage is reduced proportional to HP lost. (Max. 15%)", "text3": "Lv. 3: Incoming Damage is reduced proportional to HP lost. (Max. 30%)" },
    { "id": "gravity-training", "name": "Gravity Training", "type": "class", "text1": "Lv. 1: During combat, the Gravity Meter recovers 1% every 1s. Basic Attack and Vortex Gravity Crit Rate +10% and +4% Attack Damage to foes during Hypergravity Mode.", "text2": "Lv. 2: During combat, the Gravity Meter recovers 1.5% every 1s. Basic Attack and Vortex Gravity Crit Rate +20% and Attack Damage +10% to foes during Hypergravity Mode.", "text3": "Lv. 3: During combat, the Gravity Meter recovers 2% every 1s. +30% Basic Attack and Vortex Gravity Crit Rate and Attack Damage +20% to foes during Hypergravity Mode." },
    { "id": "grudge", "name": "Grudge", "type": "combat", "text1": "Lv. 1: Damage +4% to Boss or above monsters. Incoming Damage +20%.", "text2": "Lv. 2: Damage +10% to Boss or above monsters. Incoming Damage +20%.", "text3": "Lv. 3: Damage +20% to Boss or above monsters. Incoming Damage +20%." },
    { "id": "heavy-armor", "name": "Heavy Armor", "type": "combat", "text1": "Lv. 1: All Defense +20%. This additional Defense is immune to Defense Reduction effects.", "text2": "Lv. 2: All Defense +50%. This additional Defense is immune to Defense Reduction effects.", "text3": "Lv. 3: All Defense +100%. This additional Defense is immune to Defense Reduction effects." },
    { "id": "hit-master", "name": "Hit Master", "type": "combat", "text1": "Lv. 1: Damage of attacks other than Back Attack and Frontal Attack +3%. Does not apply to Awakening Skills.", "text2": "Lv. 2: Damage of attacks other than Back Attack and Frontal Attack +8%. Does not apply to Awakening Skills.", "text3": "Lv. 3: Damage of attacks other than Back Attack and Frontal Attack +16%. Does not apply to Awakening Skills." },
    { "id": "igniter", "name": "Igniter", "type": "class", "text1": "Lv. 1: When Magick Amplification is triggered, normal skills' Cooldown -50%. During Magick Amplification, Crit Rate +10% and Crit Damage +20%.", "text2": "Lv. 2: When Magick Amplification is triggered, normal skills' Cooldown -50%. During Magick Amplification, Crit Rate +17% and Crit Damage +35%.", "text3": "Lv. 3: When Magick Amplification is triggered, normal skills' Cooldown -50%. During Magick Amplification, Crit Rate +25% and Crit Damage +50%." },
    { "id": "increases-mass", "name": "Increases Mass", "type": "combat", "text1": "Lv. 1: Atk. Speed -10%, Atk. Power +4%.", "text2": "Lv. 2: Atk. Speed -10%. Atk. Power +10%.", "text3": "Lv. 3: Atk. Speed -10%. Atk. Power +18%." },
    { "id": "judgment", "name": "Judgment", "type": "class", "text1": "Lv. 1: Punishment Damage +15%. When Punishment skill hits, Piety Meter gain +100%. Duration of Sacred Executioner +100%.", "text2": "Lv. 2: Punishment Damage +20%. When Punishment hits, Piety Meter gain +100%. Duration of Sacred Executioner +125%.", "text3": "Lv. 3: Punishment Damage +25%. When Punishment hits, Piety Meter gain +100%. Duration of Sacred Executioner +150%." },
    { "id": "keen-blunt-weapon", "name": "Keen Blunt Weapon", "type": "combat", "text1": "Lv. 1: +10% Crit Damage but your attacks have a chance to deal Damage -20%.", "text2": "Lv. 2: +25% Crit Damage but your attacks have a chance to deal Damage -20%.", "text3": "Lv. 3: +50% Crit Damage but your attacks have a chance to deal Damage -20%." },
    { "id": "lightning-fury", "name": "Lightning Fury", "type": "combat", "text1": "Lv. 1: Attacks have a 60% chance of generating a lightning orb. These lightning orbs can only be generated once every 4s. When 5 orbs are created, they explode and Damage surrounding foes.", "text2": "Lv. 2: Attacks have a 60% chance of generating a lightning orb. These lightning orbs can only be generated once every 2s. When 5 orbs are created, they explode and Damage surrounding foes.", "text3": "Lv. 3: Attacks have a 60% chance of generating a lightning orb. These lightning orbs can only be generated once every 1s. When 5 orbs are created, they explode and Damage surrounding foes." },
    { "id": "lone-knight", "name": "Lone Knight", "type": "class", "text1": "Lv. 1: Gunlance skill Crit Rate +5%. Crit Damage +30%. Battlefield Shield cannot be used. Shield Meter consumption during Defensive Stance +100%.", "text2": "Lv. 2: Gunlance skill Crit Rate +10%. Crit Damage +40%. Battlefield Shield cannot be used. Shield Meter consumption during Defensive Stance +100%.", "text3": "Lv. 3: Crit Rate of Gunlance skills +15%. Crit Damage +50%. Battlefield Shield cannot be used. Consumption of the Shield Meter during Defensive Stance +100%." },
    { "id": "loyal-companion", "name": "Loyal Companion", "type": "class", "text1": "Lv. 1: Summons Silverhawk MK-II, allowing Move Speed +4%, Silverhawk's Basic AoE Radius +60%, Silverhawk's Basic Attack Damage +100%, and Silverhawk's summon duration +30%. On Basic Attack or Wings of Storm hit, foes get a Mark of Death: foe Damage taken +4%. Additionally, when Silverhawk is summoned Atk. Power +3%.", "text2": "Lv. 2: Summons Silverhawk MK-II, allowing Move Speed +4%, Silverhawk's Basic AoE Radius +60%, Silverhawk's Basic Attack Damage +200%, and Silverhawk's summon duration +60%. On Basic Attack or Wings of Storm hit, foes get a Mark of Death: foe Damage taken +9%. Additionally, when Silverhawk is summoned Atk. Power +6%.", "text3": "Lv. 3: Summons Silverhawk MK-II, allowing Move Speed +4%, Silverhawk's Basic AoE Radius +60%, Silverhawk's Basic Attack Damage +300%, and Silverhawk's summon duration +100%. On basic attack or Wings of Storm hit, foes get a Mark of Death: foe Damage taken +14%. Additionally, when Silverhawk is summoned Atk. Power +10%." },
    { "id": "magick-stream", "name": "Magick Stream", "type": "combat", "text1": "Lv. 1: Stacks up to +5% MP Recovery every 3s while you are not attacked. When the maximum stack is reached, skill Cooldown -3%. Being hit removes 1 stack of the effect with a Cooldown of 10s.", "text2": "Lv. 2: Stacks up to +10% MP Recovery every 3s while you are not attacked. When the maximum stack is reached, skill Cooldown -6%. Being hit removes 1 stack of the effect with a Cooldown of 10s.", "text3": "Lv. 3: Stacks up to +15% MP Recovery every 3s while you are not attacked. When the maximum stack is reached, skill Cooldown -10%. Being hit removes 1 stack of the effect with a Cooldown of 10s." },
    { "id": "master-brawler", "name": "Master Brawler", "type": "combat", "text1": "Lv. 1: Head attack Damage +5%", "text2": "Lv. 2: Head attack Damage +12%", "text3": "Lv. 3: Head attack Damage +25%" },
    { "id": "master-of-escape", "name": "Master of Escape", "type": "combat", "text1": "Lv. 1: Stand Up Action Cooldown -4% .", "text2": "Lv. 2: Stand Up Action Cooldown -12%.", "text3": "Lv. 3: Stand Up Action Cooldown -25%." },
    { "id": "masters-tenacity", "name": "Master's Tenacity", "type": "combat", "text1": "Lv. 1: Outgoing Damage +3% at 50% or lower HP.", "text2": "Lv. 2: Outgoing Damage +8% at 50% or lower HP.", "text3": "Lv. 3: Outgoing Damage +16% at 50% or lower HP." },
    { "id": "max-mp-increase", "name": "Max MP Increase", "type": "combat", "text1": "Lv. 1: Max MP +5%.", "text2": "Lv. 2: Max MP +15%.", "text3": "Lv. 3: Max MP +30%." },
    { "id": "mayhem", "name": "Mayhem", "type": "class", "text1": "Lv. 1: Fury Meter remains at max, and turns into Burst Mode with the power of darkness. Burst Mode: Outgoing Damage +3%, Atk. and Move Speed +15%, all incoming Damage -65%. When Burst Mode activates, HP is reduced to 25% of Max HP; this cannot be exceeded even when Healing is applied. Can only receive 40% of healing effects and 25% of shield effects. Press the [X] key to cancel Burst Mode and recover 25% of Max HP, but cannot enter Burst Mode again for 30s.", "text2": "Lv. 2: Fury Meter remains at max, and turns into Burst Mode with the power of darkness. Burst Mode: Outgoing Damage +8%, Atk. and Move Speed +15%, all incoming Damage -65%. When Burst Mode activates, HP is reduced to 25% of Max HP; this cannot be exceeded even when Healing is applied. Can only receive 40% of healing effects and 25% of shield effects. Press the [X] key to cancel Burst Mode and recover 25% of Max HP, but cannot enter Burst Mode again for 30s.", "text3": "Lv. 3: Fury Meter remains at max, and turns into Burst Mode with the power of darkness. Burst Mode: Outgoing Damage +16%, Atk. and Move Speed +15%, all incoming Damage -65%. When Burst Mode activates, HP is reduced to 25% of Max HP; this cannot be exceeded even when Healing is applied. Can only receive 40% of healing effects and 25% of shield effects. Press the [X] key to cancel Burst Mode and recover 25% of Max HP, but cannot enter Burst Mode again for 30s." },
    { "id": "mp-efficiency-increase", "name": "MP Efficiency Increase", "type": "combat", "text1": "Lv. 1: MP Recovery +5%. When MP is at 50% or below, Damage to foes +3%.", "text2": "Lv. 2: MP Recovery +15%. When MP is at 50% or below, Damage to foes +6%.	", "text3": "Lv. 3: MP Recovery +30%. When MP is at 50% or below, Damage to foes +12%." },
    { "id": "necromancy", "name": "Necromancy", "type": "combat", "text1": "Lv. 1: Attacks summon temporary soldiers that Damage foes. (Cooldown: 75s)", "text2": "Lv. 2: Attacks summon temporary soldiers that Damage foes. (Cooldown: 30s)", "text3": "Lv. 3: Attacks summon temporary soldiers that Damage foes. (Cooldown: 15s)" },
    { "id": "peacemaker", "name": "Peacemaker", "type": "class", "text1": "Lv. 1: Atk. Speed +8% in Handgun Stance. Crit Rate +15% in Shotgun Stance. Damage to foes +10% and additional Damage +10% for 9s to targets with 50% or lower HP while in Rifle Stance.", "text2": "Lv. 2: Atk. Speed +12% in Handgun Stance. Crit Rate +20% in Shotgun Stance. Damage +10% to foes and additional Damage +20% for 9s to targets with 50% or lower HP while in Rifle Stance.", "text3": "Lv. 3: Atk. Speed +16% in Handgun Stance. Crit Rate +25% in Shotgun Stance. Damage +10% to foes and additional Damage +30% to targets with 50% or lower HP for 9s while in Rifle Stance." },
    { "id": "perfect-suppression", "name": "Perfect Suppression", "type": "class", "text1": "Lv. 1: Normal Skill Damage +20%. Shadowburst Meter +50% for all skills. Disables Demonize.", "text2": "Lv. 2: Normal Skill Damage +25%. Shadowburst Meter +50% for all skills. Disables Demonize.", "text3": "Lv. 3: Normal Skill Damage +30%. Shadowburst Meter +50% for all skills. Disables Demonize." },
    { "id": "pinnacle", "name": "Pinnacle", "type": "class", "text1": "Lv. 1: Adds Pinnacle: Flurry/Focus I instead of the Flurry/Focus Stage 3 effect added upon changing stances while the Dual Meter is maxed at Level 3.<br>Pinnacle: Flurry I: Atk. Speed + 12.5%, Damage +12.5%, Crit Rate +20%<br>Pinnacle: Focus I: Move Speed +15%, Damage +15%, Crit Damage +37.5%", "text2": "Lv. 2: Adds Pinnacle: Flurry/Focus II instead of the Flurry/Focus Stage 3 effect added upon changing stances while the Dual Meter is maxed at Level 3.<br>Pinnacle: Flurry II: Atk. Speed + 13.8%, Damage +13.8%, Crit Rate +22.5%<br>Pinnacle: Focus II: Move Speed +15%, Damage +17.5%, Crit Damage +43.8%", "text3": "Lv. 3: Adds Pinnacle: Flurry/Focus III instead of the Flurry/Focus Stage 3 effect added upon changing stances while the Dual Meter is maxed at Level 3.<br>Pinnacle: Flurry III: Atk. Speed + 15%, Damage +15%, Crit Rate +25%<br>Pinnacle: Focus III: Move Speed +15%, Damage +20%, Crit Damage +50%" },
    { "id": "pistoleer", "name": "Pistoleer", "type": "class", "text1": "Lv. 1: Can only use the Handgun Stance. Handgun Skill Damage +30%. Stagger Damage +40%. Awakening Skill Damage +15%.", "text2": "Lv. 2: Can only use Handgun Stance. Handgun Skill Damage +50%. Stagger Damage +40%. Awakening Skill Damage +22%.", "text3": "Lv. 3: Can only use Handgun Stance. Handgun Skill Damage +70%. Stagger Damage +40%. Awakening Skill Damage +30%." },
    { "id": "precise-dagger", "name": "Precise Dagger", "type": "combat", "text1": "Lv. 1: Crit Rate +4%. Crit Damage -12%.", "text2": "Lv. 2: Crit Rate +10%. Crit Damage -12%.", "text3": "Lv. 3: Crit Rate +20%. Crit Damage -12%." },
    { "id": "preemptive-strike", "name": "Preemptive Strike", "type": "combat", "text1": "Lv. 1: When attacking Challenge or lower monsters with full HP, your attack is a guaranteed crit with +30% Damage.", "text2": "Lv. 2: When attacking Challenge or lower monsters with full HP, your attack is a guaranteed crit with +80% Damage.", "text3": "Lv. 3: When attacking Challenge or lower monsters with full HP, your attack is a guaranteed crit with +160% Damage.	" },
    { "id": "propulsion", "name": "Propulsion", "type": "combat", "text1": "Lv. 1: After using a Movement Skill, Damage of skills (excluding Basic Attack and Awakening Skills) +3% for 5s.", "text2": "Lv. 2: After using a Movement Skill, Damage of skills (excluding Basic Attack and Awakening Skills) +8% for 5s.", "text3": "Lv. 3: After using a Movement Skill, Damage of skills (excluding Basic Attack and Awakening Skills) +16% for 5s." },
    { "id": "rage-hammer", "name": "Rage Hammer", "type": "class", "text1": "Lv. 1: When using a Gravity Release Skill, Crit Rate +3% and Crit Damage +5% based on the amount of Cores used.", "text2": "Lv. 2: When using a Gravity Release Skill, Crit Rate +4% and Crit Damage +10% based on the amount of Cores used.", "text3": "Lv. 3: When using a Gravity Release Skill, Crit Rate+5% and Crit Damage +15% based on the amount of Cores used." },
    { "id": "raid-captain", "name": "Raid Captain", "type": "combat", "text1": "Lv. 1: Outgoing Damage +10% of basic Move Speed bonus percentage.", "text2": "Lv. 2: Outgoing Damage +22% of basic Move Speed bonus percentage.", "text3": "Lv. 3: Outgoing Damage +45% of basic Move Speed bonus percentage." },
    { "id": "reflux", "name": "Reflux", "type": "class", "text1": "Lv. 1: Disables Arcane Rupture, but Damage of skills (except Awakening and Movement skills) +8% and Cooldown -3%.", "text2": "Lv. 2: Disables Arcane Rupture, but Damage of skills (except Awakening and Movement skills) +12% and Cooldown -6%.", "text3": "Lv. 3: Disables Arcane Rupture, but Damage of skills (except Awakening and Movement skills) +16% and Cooldown -10%." },
    { "id": "remaining-energy", "name": "Remaining Energy", "type": "class", "text1": "Lv. 1: Art does not consume Art Meter for 2s when activated. Atk./Move Speed +6% on Surge. Atk. Power +(8%, 16%, 25%) depending on your Surge level, for 30s.", "text2": "Lv. 2: Art does not consume Art Meter for 2s when activated. Atk./Move Speed +9% on Surge. Atk. Power +(10%, 20%, 30%) depending on your Surge level, for 30s.", "text3": "Lv. 3: Art does not consume Art Meter for 2s when activated. Atk./Move Speed +12% on Surge. Atk. Power +(12%, 24%, 36%) depending on your Surge level, for 30s." },
    { "id": "robust-spirit", "name": "Robust Spirit", "type": "class", "text1": "Lv. 1: When using Hype, enters level 3 immediately. While in Hype Mode, Energy recovery speed +200%. Damage +10%.", "text2": "Lv. 2: When using Hype, enters level 3 immediately. While in Hype Mode, Energy recovery speed +200%. Damage +20%.", "text3": "Lv. 3: When using Hype, enters level 3 immediately While in Hype Mode, Energy recovery speed +200%. Damage +30%." },
    { "id": "shield-piercing", "name": "Shield Piercing", "type": "combat", "text1": "Lv. 1: Damage to shields +16%.", "text2": "Lv. 2: Damage to shields +50%.", "text3": "Lv. 3: Damage to shields +100%." },
    { "id": "shock-training", "name": "Shock Training", "type": "class", "text1": "Lv. 1: Shock skill Damage +10%. 2% of max Shock Energy recovered every 1s.", "text2": "Lv. 2: Shock skill Damage +15%. 3% of max Shock Energy recovered every 1s.", "text3": "Lv. 3: Shock skill Damage +20%. 4% of max Shock Energy recovered every 1s." },
    { "id": "sight-focus", "name": "Sight Focus", "type": "combat", "text1": "Lv. 1: When \"!!!!!\" is entered into normal chat, Sight Focus is activated for 6s. After the effect is activated, offensive skill Damage +8%. Only half of the effect is applied to Awakening Skills. Does not apply to Basic Attack. Cooldown: 30s.", "text2": "Lv. 2: When \"!!!!!\" is entered into normal chat, Sight Focus is activated for 6s. After the effect is activated, offensive skill Damage +16%. Only half of the effect is applied to Awakening Skills. Does not apply to Basic Attack. Cooldown: 30s.", "text3": "Lv. 3: When \"!!!!!\" is entered into normal chat, Sight Focus is activated for 6s. After the effect is activated, offensive skill Damage +28%. Only half of the effect is applied to Awakening Skills. Does not apply to Basic Attack. Cooldown: 30s." },
    { "id": "spirit-absorption", "name": "Spirit Absorption", "type": "combat", "text1": "Lv. 1: Atk./Move Speed +3%.", "text2": "Lv. 2: Atk./Move Speed +8%.", "text3": "Lv. 3: Atk./Move Speed +15%" },
    { "id": "stabilized-status", "name": "Stabilized Status", "type": "combat", "text1": "Lv. 1: Damage +3% when your HP is above 80%.", "text2": "Lv. 2: Damage +8% when your HP is above 80%.", "text3": "Lv. 3: Damage +16% when your HP is above 80%." },
    { "id": "strong-will", "name": "Strong Will", "type": "combat", "text1": "Lv. 1: Incoming Damage -5% while Pushed.", "text2": "Lv. 2: Incoming Damage -15% while Pushed.", "text3": "Lv. 3: Incoming Damage -30% while Pushed." },
    { "id": "super-charge", "name": "Super Charge", "type": "combat", "text1": "Lv. 1: Charge skills' charging speed 8%. Damage +4%.	", "text2": "Lv. 2: Charge skills' charging speed +20%. Damage +10%.", "text3": "Lv. 3: Charge skills' charging speed +40%. Damage +20%." },
    { "id": "surge", "name": "Surge", "type": "class", "text1": "Lv. 1: Deathblade Surge is cast at the max level of Surge Zero form, regardless of the number of Death Orbs you have. Current Deathblade Surge does not activate the effect of Remaining Energy. When Arts is activated and skills other than Basic Attacks and Awakening Skills hit, the Surge Enhancement effect stacks every 0.4 seconds to a max of 20 stacks. This effect causes Deathblade Surge Damage to increase up to 100%, Damage increases even more with larger stacks. When Death Trance ends, gain up to 100% Death Orb Meter for each Surge Enhancement effect you have.", "text2": "Lv. 2: Deathblade Surge is cast at the max level of Surge Zero form, regardless of the number of Death Orbs you have. Current Deathblade Surge does not activate the effect of Remaining Energy. When Arts is activated and skills other than Basic Attacks and Awakening Skills hit, the Surge Enhancement effect stacks every 0.4 seconds to a max of 20 stacks. This effect causes Deathblade Surge Damage to increase up to 110%, Damage increases even more with larger stacks. Each stack increases Atk. Power additionally by 0.5%. When Death Trance ends, gain up to 100% Death Orb Meter for each Surge Enhancement effect you have.", "text3": "Lv. 3: Deathblade Surge is cast at the max level of Surge Zero form, regardless of the number of Death Orbs you have. Current Deathblade Surge does not activate the effect of Remaining Energy. When Arts is activated and skills other than Basic Attacks and Awakening Skills hit, the Surge Enhancement effect stacks every 0.4 seconds to a max of 20 stacks. This effect causes Deathblade Surge Damage to increase up to 120%, Damage increases even more with larger stacks. Each stack increases Atk. Power additionally by 1%. When Death Trance ends, gain up to 100% Death Orb Meter for each Surge Enhancement effect you have." },
    { "id": "time-to-hunt", "name": "Time to Hunt", "type": "class", "text1": "Lv. 1: Crit Rate +20% for Handgun and Rifle skills. Unable to use Shotgun Stance.", "text2": "Lv. 2: Handgun and Rifle skills' Crit Rate +30%. Unable to use Shotgun Stance.", "text3": "Lv. 3: Handgun and Rifle skills' Crit Rate +40%. Unable to use Shotgun Stance." },
    { "id": "true-courage", "name": "True Courage", "type": "class", "text1": "Lv. 1: Your outgoing Damage from Serenade of Courage +10% and Crit Rate +10%.", "text2": "Lv. 2: Your outgoing Damage from Serenade of Courage +15% and Crit Rate +10%.", "text3": "Lv. 3: Your outgoing Damage from Serenade of Courage +20% and Crit Rate +10%." },
    { "id": "ultimate-skill-taijutsu", "name": "Ultimate Skill: Taijutsu", "type": "class", "text1": "Lv. 1: Natural recovery speed of Stamina Energy +300%. Stamina skill Damage +35%. Shock skill Damage -30%.", "text2": "Lv. 2: Natural recovery speed of Stamina Energy +450%. Stamina skill Damage +50%. Shock skill Damage -30%.", "text3": "Lv. 3: Natural recovery speed of Stamina Energy +600%. Stamina skill Damage +65%. Shock skill Damage -30%." },
    { "id": "vital-point-hit", "name": "Vital Point Hit", "type": "combat", "text1": "Lv. 1: Stagger attack effectiveness +6%.", "text2": "Lv. 2: Stagger attack effectiveness +18%.", "text3": "Lv. 3: Stagger attack effectiveness +36%." }
];

window.negativeEngravings = [
    { "id": "atk-power-reduction", "name": "Atk. Power Reduction", "type": "negative", "text1": "Lv. 1: Atk. Power -2%.", "text2": "Lv. 2: Atk. Power -4%.", "text3": "Lv. 3: Atk. Power -6%." },
    { "id": "atk-speed-reduction", "name": "Atk. Speed Reduction", "type": "negative", "text1": "Lv. 1: Atk. Speed -2%.", "text2": "Lv. 2: Atk. Speed -4%.", "text3": "Lv. 3: Atk. Speed -6%." },
    { "id": "defense-reduction", "name": "Defense Reduction", "type": "negative", "text1": "Lv. 1: Defense -5%.", "text2": "Lv. 2: Defense -10%.", "text3": "Lv. 3: Defense -15%." },
    { "id": "move-speed-reduction", "name": "Move Speed Reduction", "type": "negative", "text1": "Lv. 1: Move Speed -2%.", "text2": "Lv. 2: Move Speed -4%.", "text3": "Lv. 3: Move Speed -6%." }
];

window.engravingSetup = new Map();

$(document).ready(function () {
    populateEngravingDropdown();
    populateNegativeEngravingDropdown();
    $('.engraving-select').select2({
        theme: 'bootstrap-5'
    });
    $('.negative-engraving-select').select2({
        theme: 'bootstrap-5'
    });
    $('.value-select').select2({
        theme: 'bootstrap-5',
        width: '100%'
    });
    $('.stat-select').select2({
        theme: 'bootstrap-5',
        width: '100%'
    });
    var params = new URLSearchParams(window.location.search);
    if (params.has("importCode")) {
        importFromString(params.get("importCode"));
    }
});

$('.engraving-select').on("select2:open", function (e) {
    document.querySelector('.select2-search__field').focus();
});

$('.value-select').on("select2:open", function (e) {
    document.querySelector('.select2-search__field').focus();
});

$('.negative-engraving-select').on("select2:open", function (e) {
    document.querySelector('.select2-search__field').focus();
});

$('.stat-select').on("select2:open", function (e) {
    document.querySelector('.select2-search__field').focus();
});

var oldValue;

$('.engraving-select, .negative-engraving-select').on("select2:selecting", function (e) {
    oldValue = $($(e.currentTarget).find(":selected")[0]).attr("value");
});

$('.engraving-select, .negative-engraving-select').on("select2:select", function (e) {
    var newValue = e.params.data["id"];
    var numberValue = parseInt($(e.currentTarget).parent().parent().find(".value-select")[0].value);
    removeEngraving(oldValue, numberValue);
    addEngraving(newValue, numberValue);
    updateDisplay();
    oldValue = "";
});


$('.value-select').on("select2:selecting", function (e) {
    oldValue = parseInt($($(e.currentTarget).find(":selected")[0]).attr("value"));
});

$('.value-select').on("select2:select", function (e) {
    var engraving = $(e.currentTarget).parent().parent().find(".engraving-select")[0];
    if (!engraving) {
        engraving = $(e.currentTarget).parent().parent().find(".negative-engraving-select")[0];
    }
    engraving = engraving.value;
    var newNumberValue = parseInt(e.params.data["id"]);
    removeEngraving(engraving, oldValue);
    addEngraving(engraving, newNumberValue);
    updateDisplay();
    oldValue = "";
});


$('.price-input').on("keyup", function (e) {
    var prices = $('.price-input');
    var totalPrice = 0;
    for (var i = 0; i < prices.length; i++) {
        if ($(prices[i]).val()) {
            totalPrice += parseInt($(prices[i]).val());
        }
    }
    $("#total-cost-input").val((totalPrice).toLocaleString());
});

$('#importModal').on('shown.bs.modal', function (e) {
    $('#import-text').focus();
});

$("#import-button").on("click", function (e) {
    var importString = $("#import-text").val().trim();
    if (!importString) {
        $('#import-text').focus();
        return;
    }
    importString = importString.replace("Import me on https://www.loatools.com/lost-ark-engraving-planner:", "");
    importString = importString.trim();
    importFromString(importString);
    $("#import-text").val('');
    $("#importModal .btn-close").click();
});

$("#export-button").on("click", function (e) {
    var engravings = $(".engraving-select, .negative-engraving-select");
    var exportString = "";
    for (var i = 0; i < engravings.length; i++) {
        var value = $(engravings[i]).val();
        if (value) {
            exportString += value;
        }
        exportString += ","
    }
    var values = $(".value-select");
    for (var i = 0; i < values.length; i++) {
        var value = $(values[i]).val();
        if (value) {
            exportString += value;
        }
        exportString += ","
    }
    var prices = $(".price-input");
    for (var i = 0; i < prices.length; i++) {
        var value = $(prices[i]).val();
        if (value) {
            exportString += Math.floor(parseInt(value));
        }
        exportString += ","
    }
    var stats = $(".stat-select");
    for (var i = 0; i < stats.length; i++) {
        var value = $(stats[i]).val();
        if (value) {
            exportString += value;
        }
        exportString += ","
    }
    var qualities = $(".quality-input");
    for (var i = 0; i < qualities.length; i++) {
        var value = $(qualities[i]).val();
        if (value) {
            exportString += Math.floor(parseInt(value));
        }
        exportString += ","
    }
    exportString = exportString.substring(0, exportString.length - 1);
    exportString = LZString.compressToEncodedURIComponent(exportString);
    $("#export-link").text(window.location.origin + window.location.pathname + "?importCode=" + exportString);
    $("#export-text").text("Import me on " + window.location.origin + window.location.pathname + ": " + exportString);
});

$("#link-clipboard-button").on("click", function (e) {
    navigator.clipboard.writeText($("#export-link").val());
});

$("#text-clipboard-button").on("click", function (e) {
    navigator.clipboard.writeText($("#export-text").val());
});

$("#reset-button").on("click", function (e) {
    importFromString("HYe2FMBpQ6ymD51olTXLdrvP40PUgAZTyzKLqrabrJGnGcDjWpmg");
    $("#resetModal .btn-close").click();
});

function populateEngravingDropdown() {
    var lines = "<option value=\"none\" selected=\"selected\" hidden=\"hidden\">Engraving</option><br>";
    for (engraving in window.engravings) {
        lines += "<option value=\"" + engravings[engraving].id + "\">" + engravings[engraving].name + "</option><br>";
    }
    $(".engraving-select").html(lines);
    lines = "<option value=\"none\" selected=\"selected\" hidden=\"hidden\">Engraving</option><br>";
    for (engraving in window.engravings) {
        if (engravings[engraving].type == "class") {
            continue;
        }
        lines += "<option value=\"" + engravings[engraving].id + "\">" + engravings[engraving].name + "</option><br>";
    }
    $($(".engraving-select").get(12)).html(lines);
    $($(".engraving-select").get(13)).html(lines);
}

function populateNegativeEngravingDropdown() {
    var lines = "<option value=\"none\" selected=\"selected\" hidden=\"hidden\">Negative</option><br>";
    for (engraving in window.negativeEngravings) {
        lines += "<option value=\"" + negativeEngravings[engraving].id + "\">" + negativeEngravings[engraving].name + "</option><br>";
    }
    $(".negative-engraving-select").html(lines);
}

function addEngraving(id, value) {
    if (!id || id == "none") {
        return;
    }
    if (!value) {
        return;
    }
    if (!window.engravingSetup.has(id)) {
        window.engravingSetup.set(id, value);
        return;
    }
    window.engravingSetup.set(id, window.engravingSetup.get(id) + value);
}

function removeEngraving(id, value) {
    if (!id || id == "none") {
        return;
    }
    if (!value) {
        return;
    }
    window.engravingSetup.set(id, window.engravingSetup.get(id) - value);
    if (window.engravingSetup.get(id) == 0) {
        window.engravingSetup.delete(id);
    }
}

function updateDisplay() {
    if (window.engravingSetup.size == 0) {
        $(".engravings-display-container").html('');
        return;
    }
    var sortedMap = [];
    for (var key of window.engravingSetup.keys()) {
        sortedMap.push([key, window.engravingSetup.get(key)]);
    }
    sortedMap.sort(function (a, b) {
        var engravingA = getEngravingByID(a[0]);
        var engravingB = getEngravingByID(b[0]);
        if ((engravingA.type == engravingB.type) || ((engravingA.type == "combat" || engravingA.type == "class") && (engravingB.type == "combat" || engravingB.type == "class"))) {
            return b[1] - a[1];
        }
        if (engravingB.type == "negative" && (engravingA.type == "combat" || engravingA.type == "class")) {
            if (b[1] >= 5 && a[1] < 5) {
                return 1;
            }
            return -1;
        }
        if (engravingA.type == "negative" && (engravingB.type == "combat" || engravingB.type == "class")) {
            if (a[1] >= 5 && b[1] < 5) {
                return -1;
            }
            return 1;
        }
    });
    sortedMap = new Map(sortedMap);
    var html = "";
    for (var key of sortedMap.keys()) {
        engraving = getEngravingByID(key);
        var value = parseInt(sortedMap.get(key));
        var level = Math.min(Math.floor(value / 5), 3);
        html += '<div class="col-2 text-center px-0 engraving-image-col">';
        html += '<img class="engraving-image" src="/images/engravings/' + engraving.id + '.webp" alt="' + engraving.name + '">';
        html += '</div>';
        html += '<div class="col-10 engraving-text-col">';
        html += '<div class="row engraving-row">';
        html += '<div class="col-12 p-0">';
        html += '<div class="row m-0">';
        html += '<div class="col-12 engraving-border">';
        html += '<span class="engraving-text';
        if (value >= 15 && engraving.type != "negative") {
            html += ' engraving-text-done';
        }
        if (value >= 5 && engraving.type == "negative") {
            html += ' engraving-sub-level-text-chosen-red';
        }
        html += '">Lv. ' + level + ': ' + engraving.name + ' ' + value + '/15</span>';
        if (value > 15) {
            html += '<span class="extra-text">+' + (value - 15) + '&nbsp;&nbsp;</span>';
        }
        html += '</div>';
        html += '</div>';
        html += '</div>';
        html += '<div class="col-12 p-0">';
        html += '<div class="row m-0">';
        html += '<div class="col-4 p-0 text-center engraving-sub-level-text engraving-border'
        if (level == 1) {
            html = html + ' engraving-sub-level-text-chosen' + (engraving.type == "negative" ? "-red" : "");
        }
        html += '">';
        html += 'Lv. 1';
        html += '</div>';
        html += '<div class="col-4 p-0 text-center engraving-sub-level-text engraving-border';
        if (level == 2) {
            html = html + ' engraving-sub-level-text-chosen' + (engraving.type == "negative" ? "-red" : "");
        }
        html += '">';
        html += 'Lv. 2';
        html += '</div>';
        html += '<div class="col-4 p-0 text-center engraving-sub-level-text engraving-border';
        if (level == 3) {
            html = html + (engraving.type == "negative" ? " engraving-sub-level-text-chosen-red" : " engraving-text-done");
        }
        html += '">';
        html += 'Lv. 3';
        html += '</div>';
        var diamonds = [];
        value = Math.min(value, 15);
        var type = engraving.type == "negative" ? "Red" : "Blue";
        for (var i = 0; i < value; i++) {
            diamonds[i] = type;
        }
        var fill = 15 - diamonds.length;
        for (var i = 0; i < fill; i++) {
            diamonds[diamonds.length] = "Grey";
        }
        html += '<div class="col-4 p-0 engraving-diamond-container engraving-border">'
        for (var i = 0; i < 5; i++) {
            html += '<img class="diamond-image" src="/images/' + diamonds[i].toLowerCase() + '-diamond.webp" alt="' + diamonds[i] + ' Diamond">'
        }
        html += '</div>';
        html += '<div class="col-4 p-0 engraving-diamond-container engraving-border">'
        for (var i = 5; i < 10; i++) {
            html += '<img class="diamond-image" src="/images/' + diamonds[i].toLowerCase() + '-diamond.webp" alt="' + diamonds[i] + ' Diamond">'
        }
        html += '</div>';
        html += '<div class="col-4 p-0 engraving-diamond-container engraving-border">'
        for (var i = 10; i < 15; i++) {
            html += '<img class="diamond-image" src="/images/' + diamonds[i].toLowerCase() + '-diamond.webp" alt="' + diamonds[i] + ' Diamond">'
        }
        html += '</div>';
        html += '</div>';
        html += '</div>';
        html += '</div>';
        html += '</div>';
    }
    $(".engravings-display-container").html(html);
}

function importFromString(importString) {
    importString = LZString.decompressFromEncodedURIComponent(importString);
    importString = importString.split(',');
    var index = 0;

    var engravings = $(".engraving-select, .negative-engraving-select");
    for (var i = 0; i < engravings.length; i++) {
        if (importString[index]) {
            oldValue = $(engravings[i]).val();
            $(engravings[i]).val(importString[index]);
            $(engravings[i]).val(importString[index]).trigger('change');
            $(engravings[i]).trigger({
                type: 'select2:select',
                params: {
                    data: { 'id': importString[index] }
                }
            });
        }
        index++;
    }

    var values = $(".value-select");
    for (var i = 0; i < values.length; i++) {
        if (importString[index]) {
            oldValue = parseInt($(values[i]).val());
            $(values[i]).val(importString[index]);
            $(values[i]).val(importString[index]).trigger('change');
            $(values[i]).trigger({
                type: 'select2:select',
                params: {
                    data: { 'id': importString[index] }
                }
            });
        }
        index++;
    }

    var prices = $(".price-input");
    for (var i = 0; i < prices.length; i++) {
        $(prices[i]).val(importString[index]);
        index++;
    }
    prices.first().trigger("keyup");

    var stats = $(".stat-select");
    for (var i = 0; i < stats.length; i++) {
        if (importString[index]) {
            $(stats[i]).val(importString[index]);
            $(stats[i]).val(importString[index]).trigger('change');
        }
        index++;
    }

    var qualities = $(".quality-input");
    for (var i = 0; i < qualities.length; i++) {
        $(qualities[i]).val(importString[index]);
        index++;
    }
}

function getEngravingByID(id) {
    var engraving = window.engravings.find(function (element) {
        if (element["id"] == id) {
            if (element) {
                return element;
            }
        }
    });
    if (engraving) {
        return engraving;
    }
    return window.negativeEngravings.find(function (element) {
        if (element["id"] == id) {
            if (element) {
                return element;
            }
        }
    });
}